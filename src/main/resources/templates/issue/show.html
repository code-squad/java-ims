<!doctype html>
<html lang="en">
  <head>
    {{> include/header}}
  </head>
  <body>
    <div class="issues issues--wrap mdl-layout mdl-js-layout has-drawer is-upgraded">

    {{> include/navigator}}

      <main class="mdl-layout__content">
        {{#issue}}
        <div class="issues-back">
          <a href="/" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon back-btn" title="go back" role="button">
            <i class="material-icons" role="presentation">arrow_back</i>
          </a>
        </div>
        <div class="issues__posts mdl-grid">
          <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">
            <div class="mdl-card__menu">
              <a href="/updateIssue/1" class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                <i class="material-icons">edit</i>
              </a>
              <a href="/deleteIssue/1" id="issues-menu-lower-right" class="mdl-button mdl-js-button mdl-button--icon">
                <i class="material-icons">delete</i>
              </a>
            </div>
            <div class="mdl-card__title mdl-color-text--grey-50">
              <i class="material-icons">check_circle</i>
              <h2 class="mdl-card__title-text">{{subject}} #{{id}}</h2>
            </div>
            
            <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
              <img class="minilogo" height="48" width="48" src="https://avatars2.githubusercontent.com/u/520500?v=3&s=140" alt="javajigi">
              <div style="margin-right:20px;">
                <div class="author-text">
                  <strong>
                    <a href="https://github.com/javajigi" class="author">{{writer.userId}}</a>
                  </strong>
                </div>
                <span>{{formattedDate}}</span>
              </div>
              <a href="/issue/1/setOpen" class="mdl-button mdl-button--colored mdl-js-button">
                      Close issue
              </a>

              <div class="section-spacer"></div>

              <button id="milestone-menu" class="mdl-button mdl-js-button">
                Milestone
              </button>

              <!-- milestone list -->
              <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="milestone-menu">
                {{#milestones}}
                  <form class="form-delete" action="/issue/{{issue.id}}/setMilestone/{{id}}" method="POST">
                    <input type="hidden" name="_method" value="PUT">
                    <li class="mdl-menu__item">
                    <button type="submit" class="delete-answer-button">{{subject}}</button>
                    </li>
                  </form>
                {{/milestones}}
              </ul>

              <button id="label-menu" class="mdl-button mdl-js-button">
                Label
              </button>
              <!-- label list -->
              <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="label-menu">
                {{#labels}}
                <form class="form-delete" action="/issue/{{issue.id}}/setLabel/{{id}}" method="POST">
                  <input type="hidden" name="_method" value="PUT">
                  <li class="mdl-menu__item">
                    <button type="submit" class="delete-answer-button">{{name}}</button>
                  </li>
                </form>
                {{/labels}}
              </ul>

              <button id="assignee-menu" class="mdl-button mdl-js-button">
                Assignee
              </button>
              <!-- label list -->

              <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
                  for="assignee-menu">
                {{#user}}
                      <!--<li class="mdl-menu__item">-->
                        <!--<a href="/issue/{{issue.id}}/setAssignee/{{id}}">{{userId}}</a>-->
                      <!--</li>-->
                <form class="form-delete" action="/issue/{{issue.id}}/setAssignee/{{id}}" method="POST">
                  <input type="hidden" name="_method" value="PUT">
                  <li class="mdl-menu__item">
                    <button type="submit" class="delete-answer-button">{{userId}}</button>
                  </li>
                </form>
                {{/user}}
              </ul>
            </div>
            <div class="mdl-color-text--grey-700 mdl-card__supporting-text">
              <p>{{comment}}</p>
            </div>
            <div class="mdl-color-text--primary-contrast mdl-card__supporting-text comments">
              <!-- comments start -->
              {{#issue.answers}}
              <div class="comment mdl-color-text--grey-700">
                <header class="comment__header">
                  <img class="comment__avatar2" height="48" width="48" src="https://avatars2.githubusercontent.com/u/520500?v=3&s=140" alt="javajigi">
                  <div class="comment__author">
                    <strong>
                      <a>{{writer.userId}}</a>
                          <span>{{comment}} at {{formattedCreateDate}}</span>
                    </strong>
                  </div>
                </header>
              </div>
              <hr>
              <!-- comments end -->
              {{/issue.answers}}
            </div>

            <!--fileupload start-->
            <form action="/attachments" enctype="multipart/form-data" method="POST">
              <div style="margin:10px;">
                <input type="file" name="file" id="file" />
                <button class="mdl-button" type="submit">upload file</button>
              </div>
            </form>

            <div class="mdl-color-text--primary-contrast mdl-card__supporting-text new-comment">
              <form id="answerForm" action="/api/issue/{{id}}/answers" method="POST">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                  <textarea rows=5 class="mdl-textfield__input" id="comment" name="comment"></textarea>
                  <label for="comment" class="mdl-textfield__label">Leave a comment</label>
                </div>
                <button type="button" id="checkButton" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
                  <i class="material-icons" role="presentation">check</i><span class="visuallyhidden">add comment</span>
                </button>
            </form>
            </div>
          </div>
        </div>
        <footer class="mdl-mini-footer">
          <div class="mdl-mini-footer--left-section">
            <div class="mdl-logo mdl-color-text--grey-600">Proudly powered by <a href="https://github.com/Byeol">Byeol</a></div>
          </div>
        </footer>
      </main>
      <div class="mdl-layout__obfuscator"></div>
    </div>

    <!--Ajax template-->
    <script type="text/template" id="commentTemplate">
      <div class="comment mdl-color-text--grey-700">
        <header class="comment__header">
          <img class="comment__avatar2" height="48" width="48"
               src="https://avatars2.githubusercontent.com/u/520500?v=3&s=140" alt="javajigi">
          <div class="comment__author">
            <strong>
              <a>{0}</a>
              <span>changed milestone 1 on {1}</span>
              {2}
            </strong>
          </div>
        </header>
      </div>
      <hr>
    </script>
    <!-- Ajax Template end-->
    {{/issue}}
    {{> include/footer}}
  </body>
</html>